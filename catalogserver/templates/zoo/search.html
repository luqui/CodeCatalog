{% extends "zoo/frame.html" %}

{% block pagetitle %}
CodeCatalog Search
{% endblock %}

{% block header %}
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.5.1/jquery.min.js"></script>

<link href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8/themes/base/jquery-ui.css" rel="stylesheet" type="text/css" />
<script src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8/jquery-ui.min.js"></script>

<script src='/static/code_editor.js'></script>

{{ block.super }}

<style>
 .searchbox { padding-top: 1cm }
 .searchbox .center-aligned { text-align: center }
 .searchbox input { height: 30px; font-size: large }
 .searchbox #q { width: 600px }
</style>

<script>

//CodeCatalog Snippet http://codecatalog.net/279/782/
var foreach = function(array, body) {
    for (var i = 0; i < array.length; ++i) {
        body(array[i]);
    }
};
// End CodeCatalog Snippet

// CodeCatalog Snippet http://www.codecatalog.net/309/1/
var on_enter = function(element, callback) {
    return element.keypress(function(e){
        if(e.which == 13) {
            callback();
        }
    });
};
// End CodeCatalog Snippet

$(function() {
    var select = function(choice) {
        window.location.href = '/' + choice.versionptr + '/';
    };
    
    var search_box = catalog_search_with_autocomplete(select, null);
    $('#q').replaceWith(search_box);
    search_box.attr('id', 'q').attr('name','q');
    search_box.focus();
    
    var search_func = function() {
        var search_term = search_box.val();
        if (search_term) {
            window.location.href = '/search/?q=' + escape(search_term);
        }
    };
    
    on_enter(search_box, search_func);
    
    $('#search').click(search_func);
});

</script>
{% endblock %}

{% block content %}

<div class="searchbox">
 <div class='center-aligned'>
  <input type='text' name='q' id='q' />
  <button name='search' id='search'>Search</button>
 </div>
</div>

{% endblock content %}
